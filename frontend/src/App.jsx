import React from "react";
import { useState } from "react";
import axios from 'axios';

export default function BlindTestForm() {
  // --- 第 1 處修改：更新 state 結構 ---
  const [formData, setFormData] = useState({
    identity: "", // 新增
    gender: "",
    // name 和 education 已移除
    answers: {},
  });
  const [isSubmitting, setIsSubmitting] = useState(false);

  // 完整的問卷題目資料 (保持不變)
  const questions = [
    {
      id: 1,
      question: ":高醫USR空氣汙染計畫與哪所大學簽署合作協議共同推動多語言衛教教材？",
      answers: [
        "高醫USR空氣汙染計畫與文藻外語大學簽署合作協議，共同推動多語言衛教教材的研發與推廣。 合作方式主要涉及核心衛教教材的翻譯成多國語言，並進行雙語翻譯與內容優化以提升教材品質。 透過與文藻外語大學 的合作，計畫也將研發的教材在國際場合進行展示，以促進國際文化交流和知識共享。 此外，雙方還共同舉辦雙語講座與研討會，以更直接地促進跨文化知識的交流。",
        "高雄醫學大學USR空氣污染計畫與國立高雄師範大學簽署合作協議，結合雙方在醫學與語言教育領域的專長，合作推動多語言衛教教材，協助多語族群理解空污與健康知識。",
        "目前公開資訊未明確指出高雄醫學大學（高醫大）的USR空氣汙染計畫與特定「大學」簽署合作協議共同推動多語言衛教教材。高醫大主要透過其內部師生團隊研發衛教教材，並與在地國小、醫院、圖書館等社區機構合作推廣，例如與小港醫院及當地小學合作推動空污課綱及衛教活動，也有與越南軍醫的國際交流但非共同推動多語言衛教教材。",
      ],
    },
    {
      id: 2,
      question: ":高醫USR空氣汙染計畫當前主持人是誰?",
      answers: [
        "高雄醫學大學(高醫大)USR空氣汙染計畫主持人為郭藍遠教授。他是高雄醫學大學健康科學院的院長，此計畫重點針對高齡、新住民及心理疾病患者，透過居家空污監測與專題健康促進介入，提供弱勢族群健康協助。",
        "高醫USR空氣污染計畫當前主持人為誰的資訊未公開於我所能存取的訓練資料中，故無法確認其姓名，屬於「缺乏足夠資訊」。",
        "根據公開資訊，高雄醫學大學（高醫大）「空污下的大學社會責任-環境教育與健康促進永續發展計畫」的當前主持人是郭藍遠院長，他是高雄醫學大學健康科學院的院長。",
      ],
    },
    {
      id: 3,
      question: ":高醫大USR空氣汙染計畫主要場域涵蓋的四個行政區名稱。",
      answers: [
        "高醫大USR空氣汙染計畫主要場域涵蓋小港區、林園區、前鎮區、大寮區。此計畫擴增場域，並新增USR學分學程，包含環境污染、健康促進等主題，致力於改善空污弱勢族群健康，並強化國際連結與產學合作，有助於社區福祉。",
        "高醫大USR空氣污染計畫主要場域涵蓋高雄市的小港區、林園區、大寮區與鳳山區，聚焦於高風險社區的環境健康與空污教育推廣。",
        "高雄醫學大學USR空氣汙染計畫主要實踐場域涵蓋南高雄工業區周邊的行政區，包括小港區、林園區、前鎮區、大寮區。",
      ],
    },
    {
      id: 4,
      question: " :以高雄醫學大學空氣污染 USR 計畫中的課程學分學程為例，請說明計畫中的「跨院系／跨校」課程設計如何影響學生的學習成效。",
      answers: [
        "高雄醫學大學空氣污染USR計畫中的學分學程，課程設計強調跨院系及跨校合作，旨在促進學生學習成效。此學程的設計基礎是跨領域知識融合，結合環境科學、公共衛生及醫療照護等多個領域，推動共授與實地實習 ，讓學生獲得全方位實作經驗。 透過跨校聯合課程與專題研討，師生得以加強學術合作與互動，擴大學術影響力，並有效促進不同院校間的資源共享與知識交流。 此外，課程設計也結合理論與實務，並納入實地調研和企業實習，更注重解決實際問題的能力培養，提升學生學習成效。",
        "高雄醫學大學空氣污染USR計畫中的跨院系／跨校課程設計可促進學生多元視角學習，強化對空污議題的理解與實踐能力，提升其跨領域協作與問題解決能力。",
        "高雄醫學大學空氣污染USR計畫的「空氣汙染與健康微學程」等跨院系／跨校課程設計，透過整合公共衛生、呼吸治療、運動醫學等多元專業知識，並連結高中端學生參與「School Tutor跨域共學聯盟」，讓學生從理論到實踐多面向學習空污議題。這不僅深化了學生對空污健康影響的理解，也透過實際衛教活動培養其解決問題、團隊合作與社會關懷能力，顯著提升學習成效與應用知能。",
      ],
    },
    {
        id: 5,
        question: "：高雄醫學大學空氣污染 USR 計畫在聯合國永續發展目標（SDGs）中，特別著重於「良好健康與福祉」（SDG 3）與「優質教育」（SDG 4）。請用說明為何這兩項目標會被作為本計畫的重點，並簡要說明其背後的意義。",
        answers: [
            "高雄醫學大學USR空氣汙染計畫強調SDG3與SDG4，旨在透過環境教育提升居民對空氣汙染的認知，並促進健康教育，特別是針對空氣汙染引發的健康問題，如氣喘。此計畫的目標是改善居民健康與福祉，與聯合國SDG3 目標一致，致力於提升国民健康水平。計畫也關注優質教育，體現在國中健康學園的設立，旨在培養學生跨領域合作與問題解決能力，與SDG4強調的教育質量提升相符。 計畫強調SDG3與SDG4，不僅是呼應教育部USR政策，也反映了計畫核心價值，即透過教育與健康促進，提升社區居民的生活品質。SDG3關注健康福祉，意在減少環境污染對健康的負面影響；SDG4則希望透過教育提升居民自主解決環境問題的能力，使其能共同為健康環境貢獻力量。計畫的成功推動，需仰賴教育部USR政策的政策支持與資源投入。 此計畫的SDG9目標，則著重於推動產業、創新和基礎設施升級，例如跨校產學研合作及智能健康照護技術的應用。結合跨領域人才培育，並將學術知識轉化為地方發展動力，顯然展現計畫的永續發展策略。這與聯合國SDGs推動全球永續發展目標的整體方向一致。",
            "高雄醫學大學空氣污染USR計畫特別著重於「良好健康與福祉」（SDG 3）與「優質教育」（SDG 4），主要是因為空氣污染直接威脅人類健康，尤其對高風險族群如兒童、老人及慢性病患者影響更鉅，因此透過醫學專業導入社區健康促進與風險溝通，有助於提升公眾健康識能與自我防護能力，對應SDG 3的核心目標。同時，透過多語衛教教材、跨院系教學與場域實作課程，強調知識轉譯與在地實踐，使教育不僅止於知識傳授，更能成為解決現實問題的行動力，這正體現了SDG 4所倡導的包容與公平的教育精神。兩者結合突顯本計畫強調從知識傳遞到社會實踐的整合性價值，並展現大學在地參與、促進健康與教育共好的社會責任。",
            "高雄醫學大學USR空氣污染計畫將「良好健康與福祉」（SDG 3）與「優質教育」（SDG 4）列為重點，是基於其作為醫學大學的專業使命與在地社會需求。高醫大深知空氣污染對民眾健康的嚴重危害，故透過醫學專業知識推動健康促進與疾病預防，直接呼應SDG 3。同時，為達此目標並促進永續影響，必須透過教育提升民眾對空污危害的認知和自我防護能力，培養學生成為具備社會責任的健康守護者，這與SDG 4的優質教育理念不謀而合。這兩者結合，能從根本改善社區健康並建立永續的健康素養。",
        ],
    },
    {
        id: 6,
        question: ":請說明「POWER」核心理念如何呼應大學社會責任（USR）的精神與目標。",
        answers: [
            "高雄醫學大學USR空氣汙染計畫的核心理念「POWER」體現了大學社會責任的精神。此概念強調以人為核心，專業為本，並透過合作共享、實踐為體、創新為用，落實大學服務在地、解決社會問題的USR目標。教育部USR計畫亦以「在地連結」與「人才培育」為核心，高雄醫學大學的計畫正契合此政策方向。 「POWER」理念不僅回應教育部USR政策，更與政府強化空污治理的行動方案相輔相成。透過結合學術、醫療與社區力量，計畫 致力於提升社會影響力，並與國際USR趨勢接軌，促進永續發展。此核心理念並強調在大學特色類USR專案中，發揮在地實踐力、團隊合作力與跨域創新力。 計畫的推動體現了大學的社會責任，不僅是響應國家空污治 理議題，也旨在補足環境教育與健康促進需求。 透過「POWER」概念，計畫能更有效地調動各方力量，例如政府、企業與非營利組織，共同促進社區的可持續發展。",
            "「POWER」核心理念象徵高雄醫學大學USR計畫推動社會責任的行動架構，包含參與（Participation）、機會（Opportunity）、福祉（Well-being）、賦能（Empowerment）與責任（Responsibility），強調學生、教師與社區共同參與解決在地空污問題，促進健康福祉與永續發展，具體實踐USR強調的在地連結、跨域合作與社會影響力擴散目標。",
            "「POWER」核心理念與大學社會責任（USR）的精神和目標高度契合，它代表著大學運用其專業知識與資源，積極投入地方發展，解決在地問題，並培養學生成為具備社會關懷與實踐能力的未來公民。這個理念強調大學不僅是知識傳授的場所，更是社會進步的引擎，透過**專業投入（Professional engagement）**、**在地連結（On-site connection）**、**問題解決（Problem-solving）**、**賦能增力（Empowerment）**以及**永續發展（Resilience/Sustainability）**，促使大學師生走出校園，深入社區，與地方政府、產業、社區居民形成夥伴關係，共同面對挑戰，創造共好。這不僅實踐了大學服務社會的宗旨，也讓學術研究更貼近真實世界的需求，並將學術成果轉化為對社會有意義的影響力，達成聯合國永續發展目標（SDGs）所倡導的多元面向的社會責任。",
        ],
    },
    {
        id: 7,
        question: "：假設你是參與高雄醫學大學空氣污染 USR 課程的學生，請說明你如何運用課程中所學的知識與技能，協助社區推動「空污環境教育與健康促進」的衛教活動。請提出一個具體可行的活動流程。",
        answers: [
            "參與高雄醫學大學空氣污染USR課程的學生，我將運用所學知識與技能，結合校園資源與社區需求，積極參與「空污環境教育與健康促進」的衛教活動。計畫流程包括首先，運用課程所學的數據分析訓練，針對小港、 林園等社區的空污數據進行初步分析，找出當地居民最需關注的空污影響。接著，結合呼吸治療學系、公共衛生學系等跨領域知識，設計針對不同年齡層的衛教內容，例如兒童氣喘、高齡人口的呼吸系統疾病等，並以互動式工作坊、現場衛教等方式進行宣導。 為了讓社區居民更易理解並付諸行動，我會建議設計一個「家庭空污應變計畫」工作坊，教授居民如何監測空污指標、改善居家環境、並調整戶外活動時間。這將結合「School Tutor 跨域共學聯盟」模式，與其他系所學生合作，並邀請小港醫院的醫療團隊參與，提供專業諮詢及指導，確保資訊的正確性和可行性。此外，我會利用課程所學的專業技能，協助紀錄和分析活動效果，以持續優化課程內容和推廣模式。 活動流程上，初期會進行訪談與問卷調查，瞭解社區居民對空污的認知程度與需求，再根據調查結果，規劃具體活動內容，例如針對兒童的「空污繪本故事分享會」，或針對長輩的「居家 空氣淨化技巧」講座。活動結束後，會進行追蹤訪談，評估居民對空污的認識是否有所提升，以及行動是否改變，作為未來活動的參考，達成健康促進與永續發展目標",
            "若我是參與高雄醫學大學空氣污染USR課程的學生，我會運用所學的空污知識與衛教技巧，結合多語言教材與健康行動工具，在社區舉辦「空污認識與自我防護」工作坊，先透過繪本與圖卡講解空污來源與健康影響，再進行簡易肺功能檢測與智慧肺App教學，最後引導居民討論改善生活環境的方法，提升其自我健康管理與環境覺察能力。",
            "假設我是一名參與高雄醫學大學空氣污染USR課程的學生，我會運用課堂所學的空污健康危害知識、衛教溝通技巧以及教材製作經驗，協助社區推動空污環境教育與健康促進活動。一個具體可行的活動流程是：我會先與社區發展協會或里辦公室合作，針對社區居民（例如長者或學童家長）舉辦一場約90分鐘的衛教講座。活動開始時，我會透過空氣品質監測數據和在地案例，說明空污的現況與對健康的影響，並以**「氣喘大作戰」桌遊或自製的空污繪本**，搭配淺顯易懂的語言，解釋PM2.5等污染物特性及防護方法。接著，我會示範如何正確佩戴口罩、清潔居家環境，並鼓勵大家多利用環保署空氣品質監測網查詢資訊。最後，我會準備空污防護小卡作為帶回家的衛教資訊，並開放問答環節，解答居民的疑問，確保他們能將所學應用於日常生活中，提升自我防護能力，促進社區整體健康。",
        ],
    },
    {
        id: 8,
        question: ":請根據高雄醫學大學空氣污染 USR 計畫的宗旨，說明你如何結合呼吸治療學系的專業知識，設計一項針對空污敏感族群（如高齡者、癌症存活者等）的健康介入服務方案。 請說明服務對象、介入內容與執行方式。",
        answers: [
            "高雄醫學大學USR空氣汙染計畫旨在提升居民對空污的認知，並結合學術知識轉化為地方發展動力，此計畫積極應對高濃度空污對居民健康的衝擊，並針對敏感族群制定應對方案。計畫透過專項健康介入、居家改善及 專題研究，主動關懷高齡長者、新住民及心理疾病患者等弱勢群體，並提供個人健康評估等服務。呼吸治療學系專業知識可應用於設計健康介入方案，例如針對高齡者及癌症存活者等空污敏感族群，提供居家空氣監測與衛教活動。 計畫強調與地方政府、社區團體及企業合作，共同推動空污監測與健康介入工作，整合資源以提升方案的實效性。利用數據分析結果制定個別化健康介入方案，降低污染風險，同時藉由多層次衛教活動 、講座和工作坊，普及空污與健康關係知識。此計畫也符合聯合國永續發展目標SDG3與SDG4，反映了大學的社會責任。 為積極協助居民，計畫在113年9月至11月在小港、林園地區進行「呼吸治療學系社區衛教」，由 高雄醫學大學師生與社區民眾共同參與。 結合呼吸治療學系的專業知識，可以提供針對性的呼吸訓練和空氣淨化建議，並進行長期追蹤與評估，以確保居民的健康福祉。 整個計畫的總期程為2024年9月24日至2024年11月28日。",
            "根據高雄醫學大學空氣污染USR計畫的宗旨，我會結合呼吸治療學系的專業，針對高齡者與癌症存活者設計「社區肺健康守護行動」，服務對象為小港區空污暴露高風險社區居民，介入內容包含肺功能檢測、正確使用空汙防護口罩教學、環境調適建議與居家呼吸照護指導，執行方式為定期進入社區據點設站服務，並結合智慧肺健康App進行後續追蹤與衛教強化，提升族群自我照護能力與生活品質。",
            "依循高雄醫學大學空氣污染USR計畫「環境教育與健康促進」宗旨，結合呼吸治療學系專業，可設計「樂活呼吸、自在享老」健康介入服務方案。服務對象為高雄小港、林園等工業區周邊社區的高齡者及癌症存活者，因其肺部功能較弱或受損，對空污更敏感。介入內容包括：一、空污衛教：利用呼吸治療專業知識，講解空污對呼吸系統影響、認識空氣品質指標、正確佩戴口罩、居家空氣淨化（如室內植物、空氣清淨機使用）及避開空污高峰時段等。二、呼吸復健運動：指導腹式呼吸、噘嘴式呼吸等肺部復健運動，提升肺功能、改善氣道清除能力，並教導正確使用吸入劑或氧氣治療設備。三、心理支持與交流：舉辦團體活動，讓服務對象分享經驗、互相支持，減輕因空污焦慮。執行方式可採定期社區巡迴衛教講座、小團體呼吸復健班、搭配APP提醒空品資訊與運動指引，並由呼吸治療師生定期追蹤關懷，以提升其自我防護能力與生活品質。",
        ],
    },
    {
        id: 9,
        question: "：高雄醫學大學空氣污染 USR 計畫中已開發多種教育資源，例如多語繪本與肺健康衛教教材。假設你需要將這些素材推廣到非華語族群或不同文化背景社區，請設計三項具體的在地化應用策略，並簡要說明其操作方式與目的。",
        answers: [
            "高雄醫學大學USR空氣汙染計畫已發展多語繪本與肺健康衛教教材，可透過與外語院校合作，將衛教教材翻譯成多種語言，促進國際文化交流，並方便非華語族群使用。針對新住民，可以推出定制化雙語教材，提高其 環境與健康意識，並結合海外成功案例進行本土化改造，更符合地方實際情況。此外，運用多媒體工具，例如視頻與動畫，使健康教育內容更直觀易懂，提升非華語族群的理解程度，藉此增進對環境變遷及其健康影響的認識。",
            "我會透過三項在地化應用策略推廣高醫USR教育資源，第一是與在地社區領袖與翻譯志工合作，將多語繪本與教材調整為符合當地語言與文化脈絡的版本；第二是在多元族群聚集的社區辦理文化導向衛教活動，融合當地飲食、節慶等元素提升參與意願；第三是透過社群媒體平台或語音App發佈簡化版衛教內容，降低識字門檻並擴大接觸族群，讓非華語居民能更易於理解與實踐空污防護知識。",
            "目前我無法從我的訓練資料中得知高雄醫學大學空氣污染 USR 計畫的具體細節，因此無法針對其已開發的教育資源（如多語繪本與肺健康衛教教材）提供精確的在地化應用策略。若要推廣至非華語族群或不同文化背景社區，一般會建議採取以下策略：文化敏感度審查與調整，確保內容符合當地習俗與價值觀，避免誤解；與在地意見領袖或社區組織合作，透過他們的力量建立信任並有效傳播資訊；以及舉辦參與式工作坊或活動，讓目標群眾有機會互動並提供回饋，使教材更貼近他們的需求。這些策略的目的是提升教材的接受度與有效性，確保衛教資訊能被不同文化背景的社群理解與採納。",
        ],
    },
    {
        id: 10,
        question: " :比較「社區培力坊」與「空氣旅行」兩項方案在提升居民參與度上的異同，並指出各自的關鍵成功因素。",
        answers: [
            "社區培力坊與空氣旅行旨在提升居民參與度，但方式不同。培力坊側重於透過專業知識與技能培訓核心志工，再由其推廣社區衛教，著重長期性及專業性，關鍵成功在於志工的培育與持續性。空氣旅行則以主題體驗遊程，透過認識高空污環境的人文與生活樣貌，翻轉既定形象，藉由旅行體驗提升居民對空污與健康預防的重視，關鍵在於將工業區生活與居民生活緊密結合，創造情感認同。兩者皆鼓勵居民參與，前者注重深度耕耘，後者則強調感性連結，共同提升社區對環境教育及健康保健的意識。",
            "「社區培力坊」透過實地互動與在地議題討論，強調居民參與與共創意識，有助建立長期連結；而「空氣旅行」以遊戲化與探索方式吸引多元族群，提升初步參與與環境認知。前者成功關鍵在於凝聚社群，後者則仰賴創新體驗與教育趣味性。",
            "「社區培力坊」透過賦予居民能力與資源，鼓勵其主動參與社區事務與決策，提升居民對在地議題的關心與投入，其關鍵成功因素在於能否因應在地處境，有效培訓領導者、建立團隊與良好溝通，並具備勇於挑戰的企圖心。「空氣旅行」則著重於旅遊活動，可能透過推廣社區深度旅遊、生態旅遊等方式，吸引遊客同時提升當地居民的經濟效益與對環境文化的認同，進而間接鼓勵居民參與。其關鍵成功因素在於能否有效整合觀光資源、提供多元且具在地特色的體驗，並平衡遊客與居民生活品質，確保旅遊的永續性。兩者皆旨在提升居民對自身環境的參與度，前者透過內部能力建構，後者則可能透過外部資源引導，然而「空氣旅行」作為概念可能因具體操作方式而有較大的差異範圍，在提升居民參與度上可能較為間接，且目前缺乏明確資訊指出「空氣旅行」作為專門提升居民參與度的方案。",
        ],
    },
    {
        id: 11,
        question: "：高雄醫學大學空污 USR 計畫規劃了哪四大主軸? 請將這四大主軸分別對應出其主要利害關係人（例如學生、教師、社區居民、企業等），並說明每一主軸如何回應其對象的需求或關注點。",
        answers: [
            "高雄醫學大學空污USR計畫的四大軸心分別為知識教育、健康照護、社會參與、科研創新。知識教育軸心主要服務學生與教師，旨在精進大學專業人才跨領域教育，回應其對專業知識與解決問題能力的關注。健康照護 軸則面向社區居民與空污弱勢族群，提供健康關懷及改善生活品質的服務，關懷其健康需求。社會參與軸著重社區培力，服務社區居民、在地核心人才，透過合作基地與實地培訓，回應其對環境改善的期盼。科研創新軸則鏈結企業、產學界，發展如空污食療、美妝等產品，滿足其對創新產業發展及經濟效益的訴求。",
            "人才培育主要對應學生與教師，透過跨域課程與實作經驗強化其公共參與與環境健康能力；社區健康針對居民，提供空污防護與健康促進資源；場域經營則回應地方組織需求，協力建構可持續的合作網絡；創新產學著重與企業及外部單位合作，開發具實用性之環境教育與健康工具，促進知識轉譯與社會影響力擴散。",
            "很抱歉，我無法確切得知高雄醫學大學空污 USR 計畫在您提問的當下（2025年6月）的具體執行細節。我的知識截止於2024年，因此我無法提供該計畫四大主軸的確切主要利害關係人，以及這些主軸如何回應其需求或關注點的精確資訊。",
        ],
    },
    {
        id: 12,
        question: ":請解析「簡易經濟型油煙吸收桶」試辦前後對攤販作業環境的三項改善指標及其因果關係",
        answers: [
            "本計畫旨在改善攤販油煙污染物排放問題，開發簡易經濟型油煙吸收桶，具有減污效果。該桶可有效減少烹飪作業時環境上的油煙暴露及異味產生，進而減少住戶民眾的不良感受，促使攤販、餐飲業者及環境保護三方互利的和諧，共創美好生活環境。裝設簡易經濟型油煙吸收桶的推廣工作，包含技術指導、教學影片製作及裝設廠商轉介等服務，以利攤商業者客製化自行製作。 試辦前後，主要改善指標包括環境油煙暴露降低、異 味減少，以及住戶民眾反感降低。油煙桶的設計理念，著眼於減少工業區空污，並結合衛教與產學合作。 此外，學生參與空污專題研究後，能提升實驗操作、數據分析及團隊合作等綜合專業能力，對未來就業具有積 極作用。 本計畫推動有環保署、經濟部及中油公司等多方支持，並包含環境教育與人員訓練等輔助工具，以實現空污減量目標。計畫並持續進行基礎研究調查連結政策需求，及科技工具開發研究，以滾動評估整體成 效並調整策略方向。",
            "「簡易經濟型油煙吸收桶」試辦後改善三項指標包括油煙濃度下降、作業區氣味減輕與空氣流通性提升，這些改善有助於降低攤販吸入性風險與顧客反感，因果關係主要來自設備過濾與導流設計有效截留污染物並改善空氣品質。",
            "簡易經濟型油煙吸收桶試辦前後對攤販作業環境的三項改善指標主要為：空氣品質提升（如懸浮微粒和異味減少）、攤商與民眾健康風險降低（減少呼吸道疾病及致癌物暴露）、以及夜市整體形象改善（打造清潔衛生的環境）。其因果關係是：吸收桶直接吸附並過濾油煙中的有害物質，導致周遭空氣污染物顯著減少，進而降低了長期吸入油煙對攤商和民眾健康的危害，同時也促使夜市環境更加整潔，提升了消費者對夜市的觀感。這些成果可能因不同地區的油煙排放量、攤位密度與吸收桶使用率而有所差異，實際成效仍需個案評估。",
        ],
    },
    {
        id: 13,
        question: " : 請評估高雄醫學大學空污 USR 計畫對高中生「環境素養」與「公民參與度」的成效：",
        answers: [
            "高雄醫學大學USR空氣汙染計畫透過場域踏查、互動體驗等方式，讓學生親自觀察空污現象並分析其健康影響，進而提升其環境素養。計畫設計了具趣味性的互動教學活動、工作坊及校園挑戰賽，旨在鼓勵青少年參與 環保與健康促進，藉此增強其公民參與度。計畫強調社會參與式學習，鼓勵社區居民參與活動的策劃與執行，並注重培養同理心及主動關懷，提升在地社群的主體意識和自我管理能力。 計畫設立空污環境與健康生活 學分學程，結合跨領域人才培育，同時推動與小港醫院在地實踐，並符合SDG3與SDG4永續發展目標。 透過醫療團隊深入社區及企業，進行議題探討與宣導，協助居民降低空污對生活的危害。 這些活動旨在提升在地居民的環境意識與健康福祉。 計畫類型為USR萌芽型計畫，展現了高雄醫學大學大學社會責任精神，整合學校資源與在地實踐，培養學生走入社區體驗專業角色。 此計畫的成果雖未明確評估，但著重於促進青少年參與 並鼓勵在地社群主動參與，顯示其對提高高中生環境素養與公民參與度的潛在成效。",
            "高雄醫學大學空污USR計畫透過校園講座、繪本教材與互動活動，有效提升高中生對空氣污染議題的認知與批判思考能力，強化其環境素養；同時藉由參與社區活動與課程討論，鼓勵學生表達意見並參與在地行動，促進其公民參與意識與實踐力，整體具正向教育成效。",
            "高雄醫學大學的空污USR計畫旨在透過跨域合作，提升高中生對空氣品質與健康促進議題的認識，並培養解決在地問題的能力，例如與林園高中、小港高中醫學研習社合作，教授實用課程、推動衛教志工服務。這些活動有助於增進高中生的環境素養，使其了解空污與健康的關聯，並透過參與實際的教育推廣與社區服務，提升公民參與度。然而，關於其成效的具體量化數據，例如前後測問卷結果或長期影響評估，目前缺乏足夠明確的公開資訊可供精準評估，但計畫內容顯示其目標明確且執行方式有利於素養與參與度的提升。",
        ],
    },
    {
        id: 14,
        question: ": 從永續影響角度評估「高空污地區智慧肺健康門診」對地方公共衛生的長期效益，並提出佐證理由。",
        answers: [
            "高雄醫學大學USR空氣汙染計畫透過場域踏查、互動體驗等方式，讓學生親自觀察空污現象並分析其健康影響，進而提升其環境素養。計畫設計了具趣味性的互動教學活動、工作坊及校園挑戰賽，旨在鼓勵青少年參與 環保與健康促進，藉此增強其公民參與度。計畫強調社會參與式學習，鼓勵社區居民參與活動的策劃與執行，並注重培養同理心及主動關懷，提升在地社群的主體意識和自我管理能力。 計畫設立空污環境與健康生活 學分學程，結合跨領域人才培育，同時推動與小港醫院在地實踐，並符合SDG3與SDG4永續發展目標。 透過醫療團隊深入社區及企業，進行議題探討與宣導，協助居民降低空污對生活的危害。 這些活動旨在提升在地居民的環境意識與健康福祉。 計畫類型為USR萌芽型計畫，展現了高雄醫學大學大學社會責任精神，整合學校資源與在地實踐，培養學生走入社區體驗專業角色。 此計畫的成果雖未明確評估，但著重於促進青少年參與 並鼓勵在地社群主動參與，顯示其對提高高中生環境素養與公民參與度的潛在成效。",
            "高空污地區智慧肺健康門診可提升居民對呼吸健康的警覺與自主管理能力，透過早期檢測與數位追蹤降低慢性呼吸疾病惡化風險，長期有助減少醫療負擔並強化在地健康照護網絡，實現環境與健康雙向永續的公共衛生效益。",
            "由於「高空污地區智慧肺健康門診」的概念新穎，缺乏足夠的長期實證研究數據來直接評估其對地方公共衛生的永續效益。理論上，智慧門診可透過早期篩檢、精準診斷及個案管理，降低高空污地區居民肺部疾病的發生率與嚴重性，從而減輕醫療負擔，提升整體健康水平。然而，其永續影響仍需考量技術可近性、成本效益、民眾接受度及與現有醫療體系的整合度等因素，並進行長期追蹤評估才能提供確切佐證。",
        ],
    },
    {
        id: 15,
        question: "：請從「資源整合效率」、「在地實踐深度」與「永續發展潛力」三個面向，評估高雄醫學大學第四期空污 USR 計畫的整體推動成效。",
        answers: [
            "高雄醫學大學第四期空污USR計畫在資源整合效率上，透過與新南向國家國際連結合作，以及校內外多元夥伴的投入，有效提供經費、設備與技術支持，確保計畫活動順利進行。計畫也設立空污環境與健康生活學分學 程，結合跨領域人才培育，強化了在地實踐深度，將學術知識轉化為解決地方空氣汙染問題的能力，並發展新型學習成效量表及空污數據視覺化平台評估學習效果。為確保計畫能長遠持續發展，第四期計畫延續前期策略架構，並將成功經驗傳承應用到新的議題上，同時強調大學在面對地方空氣汙染挑戰時應承擔的社會責任。此一三重結合能提升計畫的永續發展潛力，並與高等教育深耕計畫的目標相符。",
            "高雄醫學大學第四期空污USR計畫在資源整合效率方面表現良好，成功串聯校內專業與外部社群；在地實踐深度則透過長期場域經營與社區參與，深化居民對空污與健康的認知；永續發展潛力方面，藉由制度化課程與多語教材開發，展現延續性與擴散可能，整體推動具穩定成效。",
            "我缺乏足夠資訊來評估高雄醫學大學第四期空污 USR 計畫的整體推動成效，因為我的知識與訓練資料無法即時更新以涵蓋此特定計畫的細節、實施過程及相關成果數據。因此，我無法從「資源整合效率」、「在地實踐深度」與「永續發展潛力」三個面向提供精準的評估。",
        ],
    },
    {
        id: 16,
        question: ":針對台灣新住民族群，提出一款多語化互動教材原型，能在 30 分鐘內完成空污防護知識學習並測驗學習成效。",
        answers: [
            "高雄醫學大學USR空氣汙染計畫第四期，針對小學空污課綱，已研發新的學習成效量表，並定期舉辦工作坊進行課綱交流，另利用GIS平台整合空污數據進行評估。為強化社區自我保護意識，計畫透過實地體驗活動與互動宣講，讓居民了解空污對健康的危害，並鏈結大學課程與場域實踐，邀請跨院系教師帶領學生深入了解空污環境對健康的影響。為促進語言及文化交流，本計畫亦與文藻外語大學簽署MOU，將桌遊及繪本譯為多種語 言版本，擴大教學資源的多元性。 針對台灣新住民群體，計畫提供雙語衛教活動和專屬課程，以協助他們融入社區，且規劃一款多語化互動教材原型，預計可在30分鐘內完成空污防護知識學習，並評估學習成效。透 過工作坊，引導師生共學研發以空污為主題的衛教桌遊教材及繪本，例如112年產出的《植物的神奇魔法》，以及113年將出版的《美麗家園-Formosa》。本計畫持續推動雙語化教案教材，並結合海外實習計畫及國際專家學者進行交流合作，擴大影響力。",
            "我設計的多語化互動教材原型為「智慧肺小學堂App」，提供中文、越南語與印尼語三種語言選擇，透過圖像動畫引導學習空污來源、健康影響與防護措施，搭配語音講解與角色互動劇情模擬，最後以五題選擇題檢測理解力，過程控制在30分鐘內完成，適用於行動裝置與平板，便於新住民家庭或社區據點使用。",
            "針對台灣新住民族群的空污防護知識學習，可設計一款名為「守護藍天家園」的多語化互動App原型，內容包含動畫短片、情境模擬問答與小遊戲，以生動有趣的方式呈現空污成因、預防措施（如佩戴口罩時機、室內空氣清淨機使用、飲食調整）與緊急應變。此App將提供繁體中文、越南語、印尼語、泰語及菲律賓語等多語言版本，並採用視覺化教學，降低語言門檻。學習過程設定為15分鐘，隨後進行15分鐘的互動測驗，測驗題型涵蓋選擇、是非及圖片配對，即時回饋學習成效並提供錯誤解析，確保新住民能在30分鐘內有效學習並評估理解程度。考量台灣各地區空污狀況不同，App可連結即時空污指標，提供在地化建議。",
        ],
    },
    {
        id: 17,
        question: ":請根據USR計畫中數位教材應用經驗，設計一項結合空污即時資料與健康建議的數位互動工具",
        answers: [
            "高雄醫學大學USR空氣汙染計畫透過多種方式普及健康促進與環境保護理念，包含課程設置、宣傳活動及公眾講座，強化民眾對空污與健康的關聯認識。計畫亦利用GIS平台整合空污數據，並研發新的學習成效量表，提升小學空汙課綱的學習成效。此外，透過工作坊、研習及School Tutor跨域共學聯盟等活動，進一步推動環境教育與健康促進理念。 計畫滾動式增修太平國小課綱，並與成功大學結合GIS運用於太平國小課程中，計畫預計每年辦理工作坊研習至少兩場，並設計國中小學空氣污健康識能教材。透過數位化工具提升師生互動，採用在線討論、虛擬實境和互動教學軟件，並透過現場踏查和互動體驗，讓學生親自觀察空污現象。為強化民眾環境意識與健康福祉，計畫同時推展高年級課綱學習成效評估計畫。 要設計結合空污即時資料與健康建議的數位互動工具，可參考計畫中GIS平台整合空污數據的經驗，即時更新顯示空污指標，並提供使用者個人化的健康建議。透過互動教學軟件，使工具更具吸引力，並整合虛擬實境，加強民眾對空污影響的理解，提升學習效果與參與感。",
            "我設計的數位互動工具為「空污即時健康助手」，結合環境部API提供的即時空氣品質資料與個人健康狀態輸入（如年齡、呼吸疾病史），即時推播個別化防護建議與行動提醒，並整合教育素材如動畫或語音說明，提升使用者對空污與健康關聯的理解與反應能力。",
            "目前無法直接存取最新的USR計畫細節或其數位教材應用經驗，因此無法精準根據USR計畫的具體經驗設計數位互動工具。然而，根據一般數位教材應用原則，若要設計一個結合空污即時資料與健康建議的數位互動工具，可以考慮開發一個響應式網頁或行動應用程式，即時串接環保署的空污監測API，呈現PM2.5、PM10等數據及AQI指數。同時，系統可根據空污等級，自動顯示對應的健康防護建議，例如「敏感族群減少戶外活動」、「配戴口罩」或「開啟空氣清淨機」，並可結合地理位置服務，提供使用者所在地的即時資訊與個人化建議。",
        ],
    },
    {
        id: 18,
        question: ":依照高醫大空氣污染 USR 計畫中已有的資源（如：智慧肺健康 App、肺健康圖卡、多語繪本、社區培力坊、跨校合作等），請設計一項三年期的創新行動方案，用於提升高風險社區居民在空氣污染下的健康素養與自我防護能力。",
        answers: [
            "高醫大空氣污染USR計畫已整合多項資源，可發展三年期創新行動方案，著重於強化高風險居民的健康素養。此方案將運用智慧肺健康App，結合多語繪本及肺健康圖卡，提供個人化健康監控與衛教資訊，降低語言與年齡層造成的理解障礙。透過社區培力坊、現場踏查及跨校合作，建立更深入的社區連結，並針對高齡者、新住民等弱勢族群提供客製化健康介入方案。 行動方案初期，聚焦於App使用者教育及圖卡繪本的普及，提升居民對空污影響及自我防護意識。中期則強化社區培力坊及現場踏查的頻率與深度，與地方政府、企業合作監測環境數據，並針對空污嚴重區域居民提供室內空氣清淨技術應用。後期將鼓勵跨領域師生共同設計更具互動性的衛教工具，並結合國中健康學園，培養年輕世代的環保意識。 此方案的核心是跨校科研力量的整合，加速智慧健康產品與應用的研發，例如結合GIS、大數據提供更精準的健康預警。同時，鼓勵師生運用創新工作坊，開發實用的桌遊與互動教材，並強化國中健康學園的課程實踐，提升年輕世代的參與度與健康素養。 整個三年期行動方案以居民參與為核心，透過多樣化的資源整合與科技應用，期能有效提升高風險社區居民在 空氣污染下的健康素養與自我防護能力，建立更健康、永續的社區環境。",
            "我設計的三年期創新行動方案為「智慧肺共學社區計畫」，第一年以智慧肺App與多語教材進行基礎衛教與數位識能推廣，第二年透過社區培力坊導入實作課程與居民共學小組，第三年結合跨校資源辦理行動健康檢測與成果展，逐步提升高風險社區居民對空污的理解、預防行為與健康管理能力。",
            "根據高醫大空氣污染 USR 計畫現有資源，一項三年期創新行動方案可聚焦於「智慧空污健康管家」計畫。第一年，運用智慧肺健康App與多語繪本推廣基礎知識，並透過社區培力坊進行志工培訓，建立種子教師網絡。第二年，將肺健康圖卡融入社區據點活動，強化高風險族群的互動式學習，同時深化跨校合作，拓展監測網絡與資源整合。第三年，著重於行動方案成效評估與模式優化，開發進階App功能，如個人化暴露風險評估與即時防護建議，並將成功經驗推廣至其他高風險社區，形成永續的自我防護社群。此方案將整合數位科技與社區參與，提升居民健康素養與實際應對空污的能力。",
        ],
    },
  ];

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setFormData((prev) => ({ ...prev, [name]: value }));
  };

  const updateAnswer = (questionId, answerIndex, newValues) => {
    setFormData((prev) => {
      const newAnswers = JSON.parse(JSON.stringify(prev.answers));
      if (!newAnswers[questionId]) {
        newAnswers[questionId] = {};
      }
      if (!newAnswers[questionId][answerIndex]) {
        newAnswers[questionId][answerIndex] = {};
      }
      Object.assign(newAnswers[questionId][answerIndex], newValues);
      return { ...prev, answers: newAnswers };
    });
  };

  const handlePreferenceChange = (questionId, preferredAnswerIndex) => {
    questions.find(q => q.id === questionId).answers.forEach((_, index) => {
      updateAnswer(questionId, index, { is_preferred: false });
    });
    updateAnswer(questionId, preferredAnswerIndex, { is_preferred: true });
  };

  // --- 第 2 處修改：更新 handleSubmit 函式 ---
  const handleSubmit = async (e) => {
    e.preventDefault();
    setIsSubmitting(true);
    
    // 建立要提交的資料，並自動加入年份
    const submissionData = {
      ...formData,
      submissionYear: new Date().getFullYear(), // 自動記錄當前年份
    };
    
    const API_ENDPOINT = 'https://react-survey-fullstack.onrender.com/submit-form';

    try {
      // 將包含年份的 submissionData 送出
      const response = await axios.post(API_ENDPOINT, submissionData);
      console.log('Server Response:', response.data);
      alert('問卷已成功提交！感謝您的填寫。');
      
      // 更新表單重置的欄位
      setFormData({ 
        identity: "", 
        gender: "", 
        answers: {} 
      });

    } catch (error) {
      console.error('提交失敗:', error);
      if (error.response) {
        alert(`提交失敗：${error.response.data.message || '伺服器發生錯誤，請稍後再試。'}`);
      } else if (error.request) {
        alert('提交失敗：無法連接到伺服器。');
      } else {
        alert(`提交失敗： ${error.message}`);
      }
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <div className="p-6 max-w-4xl mx-auto bg-white shadow-md rounded-lg my-8">
      <form onSubmit={handleSubmit}>
        
        {/* ===== 主標題區塊 (保持不變) ===== */}
        <div className="text-center mb-8">
            <h1 className="text-3xl font-bold text-gray-800">模型回答盲測評估問卷</h1>
            <p className="text-gray-600 mt-2">
                請依據每題所附的三段回答，評估其準確性與完整性。請勿根據語氣或風格判斷出處，務必專注於回答內容本身。
            </p>
        </div>

        {/* ===== 問卷說明區塊 (保持不變) ===== */}
        <div className="mb-10 p-6 border-l-4 border-teal-500 bg-teal-50 rounded-lg shadow-sm">
          <h2 className="text-2xl font-bold text-teal-800 mb-4">問卷說明</h2>
          <p className="text-gray-700 mb-3 leading-relaxed">
            歡迎您參與本研究問卷，感謝您撥冗協助！
          </p>
          <p className="text-gray-700 mb-3 leading-relaxed">
            本問卷旨在評估三種不同人工智慧語言模型的回答品質。每一題會呈現同一個問題，搭配三個匿名模型（模型1、模型2、模型3）的回應。請您根據每段回答的內容，評估其準確性（3分制）與完整性（5分制），並於最後選出您認為表現最佳的模型。
          </p>
          <p className="text-gray-700 mb-3 leading-relaxed">
            為確保評估的公平性與科學性，所有模型皆使用相同的提示語（Prompt），並隨機排序展示。問卷採盲測設計，不標示模型來源，填答結果僅用於學術分析，資料將完全匿名處理。
          </p>
          <p className="text-gray-700 leading-relaxed">
            預計填答時間為 15 分鐘，調查結果將於一個月內彙整，並回饋參與者研究成果摘要。若有任何問題，歡迎與研究者聯繫。再次感謝您的參與！
          </p>
        </div>

        {/* --- 第 3 處修改：更新「基本資料」區塊的 JSX --- */}
        <div className="space-y-12">
            <div className="p-6 border-t-4 border-gray-400 rounded-lg shadow-sm bg-white">
                <h2 className="text-xl font-bold mb-4 text-gray-800">
                    <span className="text-gray-600">基本資料</span>
                </h2>
                <div className="space-y-6 bg-gray-50 p-6 rounded-md">
                    <div>
                        <label className="block font-semibold text-gray-700 mb-1">身分</label>
                        <select
                            name="identity"
                            className="border border-gray-300 p-2 w-full rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            required
                            onChange={handleInputChange}
                            value={formData.identity}
                        >
                            <option value="">請選擇</option>
                            <option value="教師">教師</option>
                            <option value="學生">學生</option>
                            <option value="職員">職員</option>
                        </select>
                    </div>
                    <div>
                        <label className="block font-semibold text-gray-700 mb-1">性別</label>
                        <select
                            name="gender"
                            className="border border-gray-300 p-2 w-full rounded-md bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            required
                            onChange={handleInputChange}
                            value={formData.gender}
                        >
                            <option value="">請選擇</option>
                            <option value="男">男</option>
                            <option value="女">女</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    {/* 姓名和學歷欄位已移除 */}
                </div>
            </div>

            {/* 問卷題目區塊 (保持不變) */}
            {questions.map((q, qIndex) => (
                <div key={q.id} className="p-6 border-t-4 border-blue-500 rounded-lg shadow-sm bg-white">
                    <h2 className="text-xl font-bold mb-4 text-gray-800">
                        <span className="text-blue-600">第 {qIndex + 1} 題</span><br/>
                        📖 {q.question}
                    </h2>
                    <div className="space-y-6">
                        {q.answers.map((a, idx) => (
                            <div key={idx} className="p-4 border border-gray-200 rounded-md bg-gray-50">
                                <p className="font-semibold text-gray-700 mb-2">模型回答 {idx + 1}</p>
                                <p className="text-gray-800 mb-4 whitespace-pre-wrap leading-relaxed">{a}</p>

                                <div className="space-y-4">
                                    <div>
                                        <label className="block font-medium text-sm text-gray-600 mb-1">回答 {idx + 1} 的準確性（Accuracy）</label>
                                        <select
                                            className="border border-gray-300 p-2 w-full rounded-md bg-white"
                                            required
                                            value={formData.answers[q.id]?.[idx]?.accuracy || ''}
                                            onChange={(e) => {
                                              const newAccuracy = e.target.value;
                                              const updates = { accuracy: newAccuracy };
                                              if (newAccuracy !== '3') {
                                                  updates.completeness = ''; // 清空完整性
                                              }
                                              updateAnswer(q.id, idx, updates);
                                            }}
                                        >
                                            <option value="">請選擇</option>
                                            <option value="1">1 = 明顯錯誤或誤導</option>
                                            <option value="2">2 = 部分錯誤但仍有資訊價值</option>
                                            <option value="3">3 = 完全正確或僅有微小偏差</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label className="block font-medium text-sm text-gray-600 mb-1">回答 {idx + 1} 的完整性（Completeness）<span className="text-red-500">※ 僅當準確性為3時評估</span></label>
                                        <select
                                          className="border border-gray-300 p-2 w-full rounded-md bg-white disabled:bg-gray-200 disabled:cursor-not-allowed"
                                          disabled={formData.answers[q.id]?.[idx]?.accuracy !== '3'}
                                          value={formData.answers[q.id]?.[idx]?.completeness || ''}
                                          onChange={(e) => updateAnswer(q.id, idx, { completeness: e.target.value })}
                                        >
                                            <option value="">請選擇</option>
                                            <option value="1">1 = 僅提及部分重點</option>
                                            <option value="2">2</option>
                                            <option value="3">3 = 普通完整</option>
                                            <option value="4">4</option>
                                            <option value="5">5 = 涵蓋所有關鍵資訊</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                     <div className="mt-8 pt-6 border-t border-dashed border-gray-300">
                        <h3 className="text-lg font-semibold text-gray-800 mb-3">
                            綜合考量後，您最偏好第 {qIndex + 1} 題的哪個模型回答？
                        </h3>
                        <div className="space-y-2">
                            {q.answers.map((_, idx) => (
                                <label key={idx} className="flex items-center p-3 rounded-md hover:bg-blue-50 cursor-pointer">
                                    <input
                                        type="radio"
                                        name={`preference-q${q.id}`}
                                        required
                                        className="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300"
                                        onChange={() => handlePreferenceChange(q.id, idx)}
                                    />
                                    <span className="ml-3 text-md font-medium text-gray-700">
                                        模型回答 {idx + 1}
                                    </span>
                                </label>
                            ))}
                        </div>
                    </div>
                </div>
            ))}
        </div>
        
        <div className="mt-10 text-center">
            <button 
                type="submit" 
                className="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition duration-300 disabled:bg-gray-400 disabled:cursor-not-allowed"
                disabled={isSubmitting}
            >
                {isSubmitting ? '提交中...' : '提交問卷'}
            </button>
        </div>
      </form>
    </div>
  );
}
